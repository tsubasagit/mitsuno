# 3つの質問システム作成 - クライアント向け説明書

## 📋 目次

1. [システム概要](#システム概要)
2. [アカウント情報](#アカウント情報)
3. [よくある質問（FAQ）](#よくある質問faq)
4. [Difyの操作方法](#difyの操作方法)
5. [トラブルシューティング](#トラブルシューティング)
6. [技術情報](#技術情報)

---

## システム概要

### アプリ名
**3つの質問**

### サービスURL
https://tsubasagit.github.io/mitsuno/

### 機能説明
- ユーザーが自分の立場（職業など）を入力すると、AIが3つの質問を自動生成します
- 生成された質問を選択して、Twitter（X）に投稿できます
- ユーザー登録やログインは不要で、誰でもすぐに利用できます
- ユーザーのデータは一切保存されません

### 主な特徴
- ✅ シンプルな1ページ構成
- ✅ レスポンシブデザイン（スマートフォン対応）
- ✅ ユーザー登録不要
- ✅ データ保存なし（プライバシー重視）

---

## アカウント情報

### Difyアカウント

#### ログイン情報
- **ログインアドレス**: kyonyu392@svk.jp
- **確認コード承認先メール**: metem0@gmail.com
- **パスワード**: メール認証のため設定なし

#### 重要事項
⚠️ **メールアドレスの変更について**
- 現在、確認コードは `metem0@gmail.com` に送信されます
- 後日、メールアドレスの変更が必要です
- 変更時は、Difyのアカウント設定からメールアドレスを更新してください

#### DifyダッシュボードURL
https://cloud.dify.ai/

---

## よくある質問（FAQ）

### Q1. 質問が生成されない場合はどうすればいいですか？
**A.** 以下の点を確認してください：
- インターネット接続が正常か確認
- ブラウザのコンソール（F12キー）でエラーメッセージを確認
- DifyのAPI Keyが正しく設定されているか確認（技術者に確認）

### Q2. Twitter投稿ができない場合は？
**A.** 以下の点を確認してください：
- ポップアップブロッカーが有効になっていないか確認
- ブラウザの設定でポップアップを許可
- 新規タブでTwitterが開かれているか確認

### Q3. 生成される質問の内容を変更したい場合は？
**A.** Difyのワークフローでプロンプトを編集することで変更できます。詳細は「[Difyの操作方法](#difyの操作方法)」を参照してください。

### Q4. APIの使用制限はありますか？
**A.** Difyの無料アカウントには使用制限があります。制限に達した場合は、Difyのダッシュボードで確認できます。

### Q5. サイトのURLを変更したい場合は？
**A.** GitHub Pagesの設定を変更する必要があります。技術者にご相談ください。

---

## Difyの操作方法

### 1. Difyにログイン

1. https://cloud.dify.ai/ にアクセス
2. 「ログイン」をクリック
3. メールアドレス `kyonyu392@svk.jp` を入力
4. 「確認コードを送信」をクリック
5. `metem0@gmail.com` に送信された確認コードを入力
6. ログイン完了

### 2. ワークフローの確認

1. 左側のメニューから「ワークフロー」を選択
2. 「3つの質問」または該当するワークフローを開く

### 3. プロンプトの編集（質問生成ロジックの変更）

1. ワークフロー画面で「LLM」ノードをクリック
2. 「設定」タブを開く
3. 「プロンプト」セクションを編集
4. 変更後、「保存」をクリック
5. 「公開」ボタンをクリックして変更を反映

#### プロンプトの例
```
ユーザーの立場: {{job}}

この立場の人に対して、深く考えさせられる3つの質問を生成してください。
各質問は15文字以内で、簡潔で印象的なものにしてください。

出力形式:
質問1: [質問内容]
質問2: [質問内容]
質問3: [質問内容]
```

### 4. ワークフローのテスト実行

1. ワークフロー画面の右上にある「テスト実行」ボタンをクリック
2. 「入力」タブで、テスト用の値を入力（例: `job: エンジニア`）
3. 「実行」ボタンをクリック
4. 「結果」タブで出力を確認

### 5. API Keyの確認・変更

#### Dify API Key（フロントエンド用）
1. 左側のメニューから「開発」を選択
2. 「API Keys」タブを開く
3. 現在のAPI Keyを確認（現在: `app-dOfcQah0UE6uA6q0nxk9RZXH`）
4. 新しいAPI Keyを生成する場合は「作成」をクリック
5. ⚠️ **注意**: Dify API Keyを変更した場合は、`config.js`ファイルも更新する必要があります

#### OpenAI API Key（Dify側で管理）
- OpenAI API KeyはDifyのアカウント設定で管理されています
- 現在、gpt-4oモデルを使用するように設定されています
- OpenAI API Keyの確認・変更は、Difyのアカウント設定から行えます
- ⚠️ **重要**: OpenAI API KeyはDify側で管理されているため、フロントエンドのコードには含まれていません

### 6. ワークフローの変数設定

1. ワークフロー画面で「Webhook」ノードをクリック
2. 「入力変数」セクションを確認
3. 変数名が `job` になっていることを確認
   - 変数名が異なる場合は、`script.js`の`generateQuestionsViaDify`関数内の`inputs`を修正する必要があります

### 7. エラーが発生した場合

#### よくあるエラーと対処法

**エラー: `json_schema` が原因の場合**
- LLMノードの設定で「構造化出力」や「JSONスキーマ」が有効になっている可能性があります
- LLMノードの設定を開き、構造化出力関連の設定を無効化してください

**エラー: API Keyが無効**
- DifyのダッシュボードでAPI Keyを確認
- `config.js`ファイルのAPI Keyが正しいか確認

**エラー: 変数名が一致しない**
- ワークフローの入力変数名と`script.js`の`inputs`内の変数名が一致しているか確認

---

## トラブルシューティング

### 問題: 質問が生成されない

**確認事項:**
1. ブラウザのコンソール（F12）でエラーメッセージを確認
2. DifyのAPI Keyが正しく設定されているか確認
3. Difyのワークフローが公開されているか確認
4. インターネット接続を確認

**解決方法:**
- エラーメッセージに基づいて対処
- Difyのダッシュボードでワークフローの状態を確認
- 必要に応じて技術者に連絡

### 問題: Twitter投稿が開かない

**確認事項:**
1. ポップアップブロッカーが有効になっていないか
2. ブラウザの設定でポップアップを許可
3. 新規タブで開かれているか確認

**解決方法:**
- ブラウザの設定でポップアップを許可
- 手動でTwitterの投稿画面を開く

### 問題: Difyにログインできない

**確認事項:**
1. 確認コードが正しく入力されているか
2. `metem0@gmail.com` に確認コードが届いているか
3. 確認コードの有効期限（通常5-10分）が切れていないか

**解決方法:**
- 確認コードを再送信
- メールの迷惑メールフォルダを確認
- 時間を置いて再度試す

---

## 技術情報

### GitHubリポジトリ
https://github.com/tsubasagit/mitsuno

### 使用技術
- **フロントエンド**: HTML, CSS, JavaScript
- **AI API**: Dify（OpenAI gpt-4o）
- **ホスティング**: GitHub Pages
- **バージョン管理**: Git/GitHub

### 主要ファイル
- `index.html`: メインのHTMLファイル
- `style.css`: スタイルシート
- `script.js`: メインのJavaScriptロジック
- `config.js`: API Keyなどの設定ファイル

### API設定
- **Dify APIエンドポイント**: `https://api.dify.ai/v1`
- **Dify API Key**: `config.js`ファイルで管理（現在: `app-dOfcQah0UE6uA6q0nxk9RZXH`）
- **ワークフロー実行エンドポイント**: `/workflows/run`

### OpenAI API設定（Dify側で管理）
- **使用モデル**: gpt-4o
- **OpenAI API Key**: Difyのアカウント設定で管理されています
  - ⚠️ **重要**: OpenAI API KeyはDify側で管理されており、フロントエンドのコードには含まれていません
  - DifyのダッシュボードでAPI Keyの確認・変更が可能です

### セキュリティに関する注意事項
- `config.js`にはDifyのAPI Keyが含まれています
- 現在は学習用として公開されていますが、Dify側で制限がかかっています
- 本番環境では、より厳格なセキュリティ対策を推奨します

---

## 連絡先・サポート

### 技術的な問題が発生した場合
- GitHubのIssuesで報告: https://github.com/tsubasagit/mitsuno/issues
- または、開発者に直接連絡

### Difyに関する問題
- Difyの公式ドキュメント: https://docs.dify.ai/
- Difyのサポート: https://cloud.dify.ai/

---

## 更新履歴

- **2024年**: 初版作成
- システムの更新や変更があった場合は、このセクションに記録してください

---

## 付録: よく使うDifyの操作

### ワークフローの公開
1. ワークフローを編集
2. 右上の「公開」ボタンをクリック
3. 変更が反映されるまで数秒待つ

### API Keyの取得
1. 「開発」→「API Keys」
2. 既存のKeyを確認、または新規作成
3. Keyをコピーして`config.js`に設定

### ワークフローのバックアップ
1. ワークフロー画面で「エクスポート」をクリック
2. JSONファイルとして保存
3. 必要に応じて「インポート」で復元

---

**最終更新日**: 2024年
**ドキュメントバージョン**: 1.0

